(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";window.finished=!1;var videoelement=!1,url="/",mobilecanvas,mobilectx,mobileplayback=!1,rot=!1,spinRate=null,playback,v,fps=10;Cesium.JsonTileImageryProvider=JsonTileImageryProvider,Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var e=0,t=this.length;t>e;e++)this[e]&&this[e].parentElement&&this[e].parentElement.removeChild(this[e])},Element.prototype.prependChild=function(e){this.insertBefore(e,this.firstChild)},window.setRotation=function(e,t,a){rot=e?[t,a]:!1},window.render=function(){var e=document.getElementsByClassName("cesium-widget")[0],t=e.children[0];return t.toDataURL("image/png")},Element.prototype.fadeOut=function(e){e="undefined"!=typeof e?e:200;var t=20,a=1/t,n=e/t,i=this,r=setInterval(function(){i.style.opacity||(i.style.opacity=1),i.style.opacity<a?(clearInterval(r),i.remove()):i.style.opacity-=a},n)},Cesium.BingMapsApi.defaultKey="NOTHING";var clock=new Cesium.Clock({startTime:Cesium.JulianDate.fromIso8601("2014-01-01"),currentTime:Cesium.JulianDate.fromIso8601("2014-01-02"),stopTime:Cesium.JulianDate.fromIso8601("2014-01-03"),clockRange:Cesium.ClockRange.LOOP_STOP,clockStep:Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER,canAnimate:!1,shouldAnimate:!1}),baselayer=null,bl_options={url:"//a.tiles.maps.eox.at/wmts/",style:"default",format:"image/jpg",tileMatrixSetID:"WGS84",maximumLevel:12,tilingScheme:new Cesium.GeographicTilingScheme({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1}),show:!0},mapid=window.location.pathname.substring(6),loadwidget=function(e){var t=new Cesium.SingleTileImageryProvider({url:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"});try{var a=new Cesium.Viewer(document.getElementById("cesiumview"),{timeline:!1,fullscreenButton:!1,baseLayerPicker:!1,homeButton:!1,infoBox:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,animation:!1,imageryProvider:t,terrainProvider:new Cesium.CesiumTerrainProvider({url:"//tiles.maps.eox.at/dem/"}),clock:clock,contextOptions:{webgl:{alpha:!0,preserveDrawingBuffer:!0}},scene3DOnly:!0,terrainExaggeration:1.15});a.scene.fxaa=!1,a.scene.backgroundColor=new Cesium.Color(0,0,0,0);var n=a;n.scene.screenSpaceCameraController.enableZoom=!1;var i=!1;n.screenSpaceEventHandler.setInputAction(function(){i=!0},Cesium.ScreenSpaceEventType.RIGHT_DOWN),n.screenSpaceEventHandler.setInputAction(function(){i=!1},Cesium.ScreenSpaceEventType.RIGHT_UP);var r=1,o=5,l=20,s=5906376272e3,m=Number.POSITIVE_INFINITY,c=20,u=.1,d=function(e){var t=n.scene.camera.positionCartographic.height,i=c*r,d=m,p=t-i,v=o*p;v=Cesium.Math.clamp(v,l,s);var g=e/a.scene.canvas.clientHeight;g=Math.min(g,u);var y=v*g;y>0&&Math.abs(t-i)<1||0>y&&Math.abs(t-d)<1||(i>t-y?y=t-i-1:t-y>d&&(y=t-d),a.scene.camera.zoomIn(y))};n.screenSpaceEventHandler.setInputAction(function(e){var t=e/4;d(t)},Cesium.ScreenSpaceEventType.WHEEL),n.screenSpaceEventHandler.setInputAction(function(e){if(i){var t=e.endPosition.y-e.startPosition.y;d(t)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),n.screenSpaceEventHandler.setInputAction(function(e){var t=e.distance.endPosition.y-e.distance.startPosition.y;d(t)},Cesium.ScreenSpaceEventType.PINCH_MOVE),document.getElementsByClassName("cesium-viewer-geocoderContainer").remove(),document.getElementsByClassName("cesium-sceneModePicker-wrapper").remove(),a.scene.hasOwnProperty("fog")&&(a.scene.fog.enabled=!1);var p=a.scene;p.globe.baseColor=new Cesium.Color(241/255,81/255,27/255,1),p._screenSpaceCameraController.inertiaSpin=0,e.rotation.active&&(rot=["l",e.rotation.speed],spinRate=parseFloat(rot[1]));var g=Date.now(),y=function(){if(p.initializeFrame(),rot){var e=Date.now(),t=(e-g)/30;g=e;var n=spinRate*t;switch(rot[0]){case"l":a.scene.camera.rotateLeft(n);break;case"r":a.scene.camera.rotateRight(n);break;case"u":a.scene.camera.rotateUp(n);break;case"d":a.scene.camera.rotateDown(n)}}a.render(),Cesium.requestAnimationFrame(y)},h=e.layers,f=function(){var e=document.createElement("canvas");e.width=v.videoWidth,e.height=v.videoHeight,mobileplayback&&(mobilecanvas.width=v.videoWidth,mobilecanvas.height=v.videoHeight);var t,n=new Cesium.GeometryInstance({geometry:new Cesium.RectangleGeometry({rectangle:L,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT})}),i=E.split("_");i=i[i.length-1],"transparent"===i?t=new Cesium.Material({fabric:{uniforms:{image:e.toDataURL(),repeat:new Cesium.Cartesian2(1,1),alpha:.5},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb",alpha:"length(texture2D(image, fract(repeat * materialInput.st)).rgb) <= 0.3 ? 0.0 : 1.0"}},flat:!0,translucent:!0}):(t=new Cesium.Material.fromType("Image"),t.uniforms.image=e.toDataURL()),O=new Cesium.Primitive({geometryInstances:[n],asynchronous:!1,appearance:new Cesium.MaterialAppearance({translucent:!1,flat:!0,closed:!0,material:t})}),a.scene.primitives.add(O)},b=function(){setTimeout(w,1e3/fps)},w=function(){playback&&(O.appearance.material._textures.image&&(mobileplayback?(mobilectx.drawImage(v,0,0,mobilecanvas.width,mobilecanvas.height),O.appearance.material._textures.image.copyFrom(mobilecanvas)):O.appearance.material._textures.image.copyFrom(v)),Cesium.requestAnimationFrame(b))},C=function(){window.finished=!0,this.play(),playback=!0,b()};if(h)for(var x=0;x<h.length;x++){var _,E=h[x].name,I=h[x].format;"service"!==I&&(_=h[x].file_field.substr(3));var S=url+_,T=null;null!==h[x].bbox_max_x&&null!==h[x].bbox_max_y&&null!==h[x].bbox_min_x&&null!==h[x].bbox_min_y&&(T=[h[x].bbox_min_x,h[x].bbox_min_y,h[x].bbox_max_x,h[x].bbox_max_y]);var A;switch(I){case"image":A={url:S},T&&(A.rectangle=Cesium.Rectangle.fromDegrees(T[0],T[1],T[2],T[3])),a.scene.imageryLayers.addImageryProvider(new Cesium.SingleTileImageryProvider(A));break;case"kml":a.dataSources.add(Cesium.KmlDataSource.load(S));break;case"json":a.scene.imageryLayers.addImageryProvider(new Cesium.JsonTileImageryProvider({url:S,layer:"none",style:"default",format:"image/png",tileMatrixSetID:"WGS84",minimumLevel:1,maximumLevel:14,tilingScheme:new Cesium.GeographicTilingScheme({numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1})}));break;case"service":var k;if("WMTS"===h[x].protocol){var P=h[x].url;P.indexOf("tiles.maps.eox.at")>=0&&(P="https://{s}.tiles.maps.eox.at/wmts/1.0.0/"+h[x].layerid+"/default/WGS84/{TileMatrix}/{TileRow}/{TileCol}.jpg"),k=12,null!==h[x].max_zoom_level&&(k=h[x].max_zoom_level),A={url:P,layer:h[x].layerid,style:"default",format:"image/jpg",tileMatrixSetID:"WGS84",maximumLevel:k,tilingScheme:new Cesium.GeographicTilingScheme({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1}),show:!0},T&&(A.rectangle=Cesium.Rectangle.fromDegrees(T[0],T[1],T[2],T[3])),a.scene.imageryLayers.addImageryProvider(new Cesium.WebMapTileServiceImageryProvider(A))}else if("TMS"===h[x].protocol){var M=h[x].converted_object_location.split("/");M=M[M.length-1],k=3,null!==h[x].max_zoom_level&&(k=h[x].max_zoom_level);var B=new Cesium.TileMapServiceImageryProvider({url:url+"layers/"+M,fileExtension:"png",maximumLevel:k});a.scene.imageryLayers.addImageryProvider(B)}break;case"video":a.scene._oit&&(a.scene._oit.isSupported=function(){return!1});var L;L=T?Cesium.Rectangle.fromDegrees(T[0],T[1],T[2],T[3]):Cesium.Rectangle.fromDegrees(-180,-90,180,90),a.scene.fxaa=!0,a.scene.backgroundColor=new Cesium.Color(255,255,255,0),v=document.createElement("video"),v.className="videoplayer",document.body.appendChild(v),v.crossOrigin="anonymous",v.preload="auto";var O;v.onloadedmetadata=f,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?(mobileplayback=!0,mobilecanvas=document.createElement("canvas"),mobilectx=mobilecanvas.getContext("2d"),v.controls=!0,v.playbackRate=.5,v.style.display="block",v.addEventListener("play",function(){v.style.display="none",playback=!0,b()})):v.oncanplay=C,v.addEventListener("ended",function(){v.play()},!1),v.src=S,v.load()}if(h[x].hasOwnProperty("legend_layer__file_field")&&null!==h[x].legend_layer__file_field){var R=document.getElementById("legends"),D=document.createElement("IMG");D.className="legendimg";var H=h[x].legend_layer__file_field.substr(3),G=url+H;D.src=G,R.prependChild(D)}}else{a.scene.globe.baseColor=new Cesium.Color(75/255,74/255,76/255,1);var N=Cesium.WebMapTileServiceImageryProvider;N.prototype.requestImage=function(e,t,a){var n="images/mapalupa_logo.png";return Cesium.ImageryProvider.loadImage(this,n)},a.scene.imageryLayers.addImageryProvider(new N({url:"",layer:"mapalupa",style:"default",tileMatrixSetID:"WGS84",rectangle:Cesium.Rectangle.fromDegrees(-180,-67,180,67),show:!0}))}var W=e.camera;W&&(p.camera.position=new Cesium.Cartesian3(W.pos_x,W.pos_y,W.pos_z),p.camera.direction=new Cesium.Cartesian3(W.dir_x,W.dir_y,W.dir_z),p.camera.up=new Cesium.Cartesian3(W.up_x,W.up_y,W.up_z),p.camera.right=new Cesium.Cartesian3(W.right_x,W.right_y,W.right_z)),Cesium.requestAnimationFrame(y),p.skyBox.show=!1,p.sun.show=!1,p.moon.show=!1,p.skyAtmosphere.show=!1}catch(F){console.log(F),document.getElementById("cesiumview").remove();var z=document.getElementById("container"),U=document.createElement("div");U.id="thumbnails";var h=e.layers;if(h)for(var x=0;x<h.length;x++){var I=h[x].format,_=h[x].file_field.substr(3),S=url+_,T=null;h[x].bbox_max_x&&h[x].bbox_max_y&&h[x].bbox_min_x&&h[x].bbox_min_y&&(T=[h[x].bbox_min_x,h[x].bbox_min_y,h[x].bbox_max_x,h[x].bbox_max_y]);var A,X;switch(I){case"image":X=document.createElement("IMG"),X.className="thumbnailimg",X.src=S,U.appendChild(X);break;case"kml":break;case"json":break;case"service":if("WMTS"===h[x].protocol){var j=[-180,-90,180,90],q=1024,J=512,Z="//a.tiles.maps.eox.at/wms?service=wms&request=getmap&version=1.1.1&layers="+h[x].layerid+"&styles=&bbox="+j[0]+","+j[1]+","+j[2]+","+j[3]+"&width="+q+"&height="+J+"&srs=EPSG:4326";X=document.createElement("IMG"),X.className="thumbnailimg",X.src=Z,U.appendChild(X)}}}z.appendChild(U);var V=document.createElement("div");V.id="message",V.innerHTML='<p>It seems your browser does not support WebGL. You should see an interactive Globe here.</p><p>Please visit our <a href="/">mapalupa FAQ</a> for more information.</p>',z.appendChild(V)}var Y=document.createElement("button");Y.type="button",Y.id="fullscreen",Y.className="cesium-button";var K=document.createElement("div");K.id="fsi",Y.appendChild(K),document.getElementsByTagName("body")[0].appendChild(Y);var Q=document.createElement("div");Q.id="mapalupa-button",Q.onclick=function(){window.open(url,"_blank")},document.getElementsByTagName("body")[0].appendChild(Q),document.getElementById("fullscreen").style.display="none",document.onmouseout=function(){document.getElementById("fullscreen").style.display="none";var e=document.createEvent("MouseEvents");e.initEvent("mouseup",!0,!0),document.getElementById("cesiumview").dispatchEvent(e)},document.onmouseover=function(){document.getElementById("fullscreen").style.display="block"},document.getElementById("fullscreen").addEventListener("click",function(){BigScreen.enabled?BigScreen.toggle():console.log("Full-screen not enabled")},!1),videoelement||(window.finished=!0)};if(mapid){var xmlhttp;xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),xmlhttp.onreadystatechange=function(){if(4===xmlhttp.readyState)if(200===xmlhttp.status){var e=JSON.parse(xmlhttp.responseText);loadwidget(e)}else 400===xmlhttp.status?console.log("There was an error 400"):console.log("something else other than 200 was returned")},xmlhttp.open("GET",url+"v1/scene/"+mapid+"?ref="+encodeURIComponent(ref),!0),xmlhttp.send()}else loadwidget({rotation:{active:!0,speed:.004}});document.onmousedown=function(){rot=!1},document.addEventListener("touchstart",function(e){rot=!1}),document.addEventListener("tap",function(e){rot=!1,BigScreen.enabled?BigScreen.toggle():console.log("Full-screen not enabled")}),window.onload=function(){if(document.getElementById("loadscreen").fadeOut(700),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0),a=e,n=t,i=document.getElementsByClassName("cesium-widget")[0],r=i.children[0];r.style.width=a+"px",r.style.height=n+"px";window.devicePixelRatio||1;r.width=a/1.5,r.height=n/1.5}},BigScreen.onenter=function(){document.getElementById("legends").style.display="block"},BigScreen.onchange=function(){},BigScreen.onexit=function(){document.getElementById("legends").style.display="none"};
},{}]},{},[1])


//# sourceMappingURL=main.js.map
var betterResults = {"20107":[24,"71","79","85","94","102","116"],"20108":[87,"98","104","108","113","117","124"],"20109":[74,"83","91","95","103","111","122"],"20113":[39,"70","82","88","95","102","121"],"20114":[61,"74","82","89","100","106","121"],"20117":[57,"86","95","102","106","111","119"],"20223":[61,"85","93","98","105","111","116"],"40724":[96,"80","87","91","95","99","105"],"41302":[83,"70","79","82","85","91","96"],"42802":[92,"78","86","89","92","95","100"],"43702":[94,"83","89","92","95","98","105"],"43707":[101,"93","97","100","102","105","109"],"53808":[66,"64","74","79","86","95","105"],"101044":[59,"42","54","59","65","72","85"],"101108":[85,"64","82","87","91","96","102"],"101109":[79,"60","76","82","87","94","100"],"101209":[68,"36","43","50","59","66","69"],"101221":[76,"61","69","74","80","84","93"],"101222":[78,"56","71","78","84","91","100"],"101223":[73,"48","64","70","77","83","93"],"101224":[86,"60","71","79","84","90","94"],"101303":[82,"67","68","75","79","85","97"],"101310":[86,"63","70","79","86","89","97"],"101311":[84,"59","62","75","81","89","97"],"101312":[81,"62","71","75","82","89","94"],"101314":[88,"63","72","78","85","91","98"],"101315":[87,"61","73","78","85","91","97"],"101316":[80,"52","61","76","86","91","98"],"101402":[85,"80","88","91","94","98","105"],"101708":[78,"53","65","74","80","87","99"],"101710":[82,"60","69","78","86","90","102"],"101801":[78,"48","57","52","67","73","79"],"101804":[76,"50","58","63","70","78","83"],"101805":[90,"62","74","79","86","90","95"],"101809":[75,"44","53","60","71","75","85"],"101817":[96,"70","77","81","87","91","96"],"101905":[92,"67","74","80","84","89","96"],"102004":[82,"52","60","69","78","84","90"],"102105":[54,"37","43","47","51","58","70"],"102106":[79,"54","64","69","76","81","92"],"102301":[83,"54","63","71","79","84","95"],"102401":[87,"60","70","76","83","87","94"],"102601":[86,"68","76","85","87","89","95"],"102709":[91,"76","84","88","91","93","100"],"102711":[101,"77","86","93","97","102","110"],"102712":[95,"73","83","87","92","97","104"],"102802":[90,"60","71","78","85","90","98"],"102903":[84,"56","65","72","78","83","88"],"102906":[94,"65","77","82","87","91","100"],"102907":[94,"67","79","84","91","96","111"],"103102":[67,"38","46","54","59","63","71"],"103205":[92,"72","81","89","95","98","106"],"103207":[97,"71","83","90","100","102","113"],"103208":[86,"60","73","79","86","91","104"],"103209":[99,"79","87","90","96","99","107"],"103210":[92,"68","82","87","91","95","102"],"103403":[90,"69","80","84","88","93","103"],"103703":[92,"70","81","85","90","94","103"],"103704":[87,"58","67","79","84","89","93"],"103902":[91,"62","72","81","84","90","98"],"103903":[90,"59","70","75","82","87","96"],"104004":[94,"68","81","85","89","94","101"],"104006":[82,"55","65","71","77","83","91"],"104103":[96,"67","79","86","91","96","103"],"104104":[83,"58","67","71","77","81","90"],"104105":[91,"65","75","82","88","92","100"],"104203":[92,"64","75","86","93","99","115"],"260108":[98,"85","91","94","97","99","105"],"260114":[102,"88","94","96","100","102","110"],"260202":[104,"90","98","102","104","106","116"],"260203":[101,"84","93","97","100","103","110"],"260204":[104,"86","96","100","104","109","122"],"260206":[100,"75","88","94","101","104","112"],"260207":[101,"77","87","91","94","99","105"],"260208":[105,"83","90","94","98","101","105"],"260305":[97,"74","87","93","98","102","109"],"260306":[94,"82","91","97","102","108","115"],"260308":[95,"84","91","94","98","103","111"],"260309":[89,"69","79","83","87","93","99"],"260310":[100,"77","88","94","98","103","110"],"260314":[90,"79","89","92","97","102","107"],"260315":[92,"68","80","86","92","95","101"],"260402":[105,"89","98","101","103","106","113"],"260503":[100,"85","93","96","99","103","112"],"260504":[106,"89","98","101","103","106","113"],"260505":[107,"92","101","104","107","110","117"],"260601":[101,"84","91","96","100","103","112"],"260603":[93,"78","87","92","96","101","107"],"260701":[102,"91","96","99","102","105","113"],"260804":[98,"82","90","94","98","103","111"],"260805":[87,"73","84","87","92","98","111"],"260807":[78,"71","80","84","90","96","108"],"261204":[101,"87","92","95","99","104","112"],"261404":[92,"90","97","101","105","111","119"],"261406":[99,"92","97","101","105","110","117"],"261408":[98,"94","101","104","107","110","115"],"261603":[81,"82","89","93","100","107","115"],"261604":[85,"99","103","107","111","117","122"],"261608":[81,"79","87","92","97","104","112"],"261702":[61,"84","93","99","104","110","127"],"261705":[89,"97","104","107","112","118","128"],"261708":[85,"87","93","98","101","106","115"],"420206":[82,"64","69","72","77","83","88"],"420403":[86,"65","73","77","83","87","95"],"420703":[69,"44","50","55","60","66","84"],"420705":[61,"44","50","54","60","69","84"],"420706":[76,"51","59","64","90","76","87"],"420805":[72,"58","68","74","81","87","104"],"420901":[94,"77","86","89","93","101","107"],"420908":[88,"73","81","86","92","100","102"],"420911":[99,"83","92","95","100","105","108"],"420912":[83,"64","74","79","87","95","104"],"420914":[96,"82","87","91","95","100","109"],"420915":[89,"77","85","89","93","100","104"],"421101":[93,"77","85","87","91","95","105"],"421103":[81,"62","70","73","78","85","95"],"421301":[66,"62","71","75","82","91","103"],"421304":[78,"71","79","83","90","98","110"],"421305":[73,"62","70","74","80","88","101"],"421405":[75,"66","77","84","91","98","107"],"421408":[82,"63","72","76","83","87","96"],"421501":[93,"78","85","89","93","98","107"],"421502":[86,"72","82","85","91","98","105"],"421602":[68,"64","73","78","84","90","105"],"421702":[63,"53","62","69","77","89","97"],"421805":[84,"76","82","85","89","93","102"],"421806":[101,"89","95","99","104","107","117"],"421807":[88,"81","89","91","95","97","113"],"421904":[81,"68","78","83","89","98","109"],"421905":[79,"66","76","82","89","96","107"],"422002":[81,"81","91","94","99","105","115"],"422102":[88,"80","89","93","98","105","115"],"422203":[69,"81","86","89","97","105","116"],"422502":[72,"82","90","94","99","106","118"],"422503":[60,"74","85","90","97","103","109"],"422604":[50,"64","74","80","87","95","108"],"422606":[35,"67","77","82","91","101","114"],"422608":[57,"50","76","81","90","94","108"],"422609":[37,"58","70","73","82","90","100"],"422610":[64,"65","74","80","90","100","115"],"422710":[52,"58","71","78","86","95","110"],"422711":[76,"75","85","91","96","103","115"],"422712":[64,"70","81","87","94","97","107"],"422803":[67,"72","80","86","91","100","112"],"422805":[81,"96","102","104","110","115","119"],"422806":[80,"95","101","105","110","115","126"],"422807":[49,"61","68","73","80","86","95"],"422808":[78,"89","96","101","105","111","116"],"422902":[69,"80","86","92","100","107","116"],"422903":[41,"66","74","81","88","96","102"],"480707":[76,"51","59","64","71","77","81"],"480708":[76,"47","55","61","65","73","78"],"481208":[86,"57","68","75","81","87","92"],"481302":[58,"38","48","52","58","65","53"],"481306":[57,"39","45","50","55","65","73"],"481307":[64,"43","53","57","65","72","79"],"481309":[68,"47","56","60","68","74","83"]}
var results = {"20107":24,"20108":87,"20109":74,"20113":39,"20114":61,"20117":57,"20223":61,"40724":96,"41302":83,"42802":92,"43702":94,"43707":101,"53808":66,"101044":59,"101108":85,"101109":79,"101209":68,"101221":76,"101222":78,"101223":73,"101224":86,"101303":82,"101310":86,"101311":84,"101312":81,"101314":88,"101315":87,"101316":80,"101402":85,"101708":78,"101710":82,"101801":78,"101804":76,"101805":90,"101809":75,"101817":96,"101905":92,"102004":82,"102105":54,"102106":79,"102301":83,"102401":87,"102601":86,"102709":91,"102711":101,"102712":95,"102802":90,"102903":84,"102906":94,"102907":94,"103102":67,"103205":92,"103207":97,"103208":86,"103209":99,"103210":92,"103403":90,"103703":92,"103704":87,"103902":91,"103903":90,"104004":94,"104006":82,"104103":96,"104104":83,"104105":91,"104203":92,"260108":98,"260114":102,"260202":104,"260203":101,"260204":104,"260206":100,"260207":101,"260208":105,"260305":97,"260306":94,"260308":95,"260309":89,"260310":100,"260314":90,"260315":92,"260402":105,"260503":100,"260504":106,"260505":107,"260601":101,"260603":93,"260701":102,"260804":98,"260805":87,"260807":78,"261204":101,"261404":92,"261406":99,"261408":98,"261603":81,"261604":85,"261608":81,"261702":61,"261705":89,"261708":85,"420206":82,"420403":86,"420703":69,"420705":61,"420706":76,"420805":72,"420901":94,"420908":88,"420911":99,"420912":83,"420914":96,"420915":89,"421101":93,"421103":81,"421301":66,"421304":78,"421305":73,"421405":75,"421408":82,"421501":93,"421502":86,"421602":68,"421702":63,"421805":84,"421806":101,"421807":88,"421904":81,"421905":79,"422002":81,"422102":88,"422203":69,"422502":72,"422503":60,"422604":50,"422606":35,"422608":57,"422609":37,"422610":64,"422710":52,"422711":76,"422712":64,"422803":67,"422805":81,"422806":80,"422807":49,"422808":78,"422902":69,"422903":41,"480707":76,"480708":76,"481208":86,"481302":58,"481306":57,"481307":64,"481309":68}
var rawPoints = [
  {
    "name":"Cart Creek",
    "lat":40.884722,
    "lon":-109.416944,
    "id":420805,
    "highest":104,
    "p97":87,
    "p90":81,
    "p80":74,
    "p70":68,
    "p50":58
  },
  {
    "name":"Catfish",
    "lat":44.326111,
    "lon":-117.169444,
    "id":101402,
    "highest":105,
    "p97":98,
    "p90":93,
    "p80":89,
    "p70":84,
    "p50":73
  },
  {
    "name":"3 Mile",
    "lat":44.396,
    "lon":-112.108,
    "id":102004,
    "highest":90,
    "p97":84,
    "p90":78,
    "p80":69,
    "p70":60,
    "p50":52
  },
  {
    "name":"Alligator Ridge",
    "lat":39.737,
    "lon":-115.518,
    "id":260804,
    "highest":111,
    "p97":103,
    "p90":98,
    "p80":94,
    "p70":90,
    "p50":82
  },
  {
    "name":"Antelope Lake",
    "lat":41.685,
    "lon":-116.764,
    "id":260310,
    "highest":110,
    "p97":103,
    "p90":98,
    "p80":94,
    "p70":88,
    "p50":77
  },
  {
    "name":"Aragonite",
    "lat":40.597,
    "lon":-113.021,
    "id":420911,
    "highest":108,
    "p97":105,
    "p90":100,
    "p80":95,
    "p70":92,
    "p50":83
  },
  {
    "name":"Archo",
    "lat":43.623,
    "lon":-113.387,
    "id":101905,
    "highest":96,
    "p97":89,
    "p90":84,
    "p80":80,
    "p70":74,
    "p50":67
  },
  {
    "name":"Asay Bench",
    "lat":37.5,
    "lon":-112.5,
    "id":422604,
    "highest":108,
    "p97":95,
    "p90":87,
    "p80":80,
    "p70":74,
    "p50":64
  },
  {
    "name":"Badger Springs",
    "lat":37.152,
    "lon":-113.951,
    "id":422806,
    "highest":126,
    "p97":115,
    "p90":110,
    "p80":105,
    "p70":101,
    "p50":95
  },
  {
    "name":"Beacon",
    "lat":40.558,
    "lon":-116.758,
    "id":260505,
    "highest":117,
    "p97":110,
    "p90":107,
    "p80":104,
    "p70":101,
    "p50":92
  },
  {
    "name":"Bear River",
    "lat":40.883,
    "lon":-110.817,
    "id":420703,
    "highest":84,
    "p97":66,
    "p90":60,
    "p80":55,
    "p70":50,
    "p50":44
  },
  {
    "name":"Big Indian",
    "lat":38.221,
    "lon":-109.279,
    "id":422711,
    "highest":115,
    "p97":103,
    "p90":96,
    "p80":91,
    "p70":85,
    "p50":75
  },
  {
    "name":"Blackrock Portable",
    "lat":36.79,
    "lon":-113.747,
    "id":20114,
    "highest":121,
    "p97":106,
    "p90":100,
    "p80":89,
    "p70":82,
    "p50":74
  },
  {
    "name":"Bluewing",
    "lat":40.335,
    "lon":-119.09,
    "id":260202,
    "highest":116,
    "p97":106,
    "p90":104,
    "p80":102,
    "p70":98,
    "p50":90
  },
  {
    "name":"Bonanza",
    "lat":44.372,
    "lon":-114.729,
    "id":101801,
    "highest":79,
    "p97":73,
    "p90":67,
    "p80":52,
    "p70":57,
    "p50":48
  },
  {
    "name":"Brace Flat",
    "lat":42.35,
    "lon":-116.686,
    "id":103207,
    "highest":113,
    "p97":102,
    "p90":100,
    "p80":90,
    "p70":83,
    "p50":71
  },
  {
    "name":"Bridgeport",
    "lat":38.248,
    "lon":-119.22,
    "id":43702,
    "highest":105,
    "p97":98,
    "p90":95,
    "p80":92,
    "p70":89,
    "p50":83
  },
  {
    "name":"Bruin Point ",
    "lat":39.608,
    "lon":-110.292,
    "id":421702,
    "highest":97,
    "p97":89,
    "p90":77,
    "p80":69,
    "p70":62,
    "p50":53
  },
  {
    "name":"Bryson",
    "lat":39.275,
    "lon":-109.217,
    "id":422102,
    "highest":115,
    "p97":105,
    "p90":98,
    "p80":93,
    "p70":89,
    "p50":80
  },
  {
    "name":"Buck Flat",
    "lat":37.9,
    "lon":-111.683,
    "id":422606,
    "highest":114,
    "p97":101,
    "p90":91,
    "p80":82,
    "p70":77,
    "p50":67
  },
  {
    "name":"Buddy Adams",
    "lat":37.021,
    "lon":-116.609,
    "id":261408,
    "highest":115,
    "p97":110,
    "p90":107,
    "p80":104,
    "p70":101,
    "p50":94
  },
  {
    "name":"Bues Canyon",
    "lat":41.18,
    "lon":-111.931,
    "id":420403,
    "highest":95,

    "p97":87,
    "p90":83,
    "p80":77,
    "p70":73,
    "p50":65
  },
  {
    "name":"Bull Springs",
    "lat":42.083,
    "lon":-114.483,
    "id":104006,
    "highest":91,
    "p97":83,
    "p90":77,
    "p80":71,
    "p70":65,
    "p50":55
  },
  {
    "name":"Cattle Camp",
    "lat":38.904,
    "lon":-114.814,
    "id":260807,
    "highest":108,
    "p97":96,
    "p90":90,
    "p80":84,
    "p70":80,
    "p50":71
  },
  {
    "name":"Cedar Mountain",
    "lat":40.301,
    "lon":-112.777,
    "id":420901,
    "highest":107,
    "p97":101,
    "p90":93,
    "p80":89,
    "p70":86,
    "p50":77
  },
  {
    "name":"Cedar pass",
    "lat":39.757,
    "lon":-114.149,
    "id":260805,
    "highest":111,
    "p97":98,
    "p90":92,
    "p80":87,
    "p70":84,
    "p50":73
  },
  {
    "name":"Challis",
    "lat":44.504,
    "lon":-114.223,
    "id":101817,
    "highest":96,
    "p97":91,
    "p90":87,
    "p80":81,
    "p70":77,
    "p50":70
  },
  {
    "name":"Clifton Flat",
    "lat":40.113,
    "lon":-113.876,
    "id":420915,
    "highest":104,
    "p97":100,
    "p90":93,
    "p80":89,
    "p70":85,
    "p50":77
  },
  {
    "name":"Coils Creek",
    "lat":39.833,
    "lon":-116.492,
    "id":260603,
    "highest":107,
    "p97":101,
    "p90":96,
    "p80":92,
    "p70":87,
    "p50":78
  },
  {
    "name":"Combs",
    "lat":39.633,
    "lon":-116.3,
    "id":260601,
    "highest":112,
    "p97":103,
    "p90":100,
    "p80":96,
    "p70":91,
    "p50":84
  },
  {
    "name":"Copper Basin",
    "lat":43.81,
    "lon":-113.846,
    "id":101804,
    "highest":83,
    "p97":78,
    "p90":70,
    "p80":63,
    "p70":58,
    "p50":50
  },
  {
    "name":"Coyote Wash",
    "lat":38.283,
    "lon":-114.758,
    "id":261603,
    "highest":115,
    "p97":107,
    "p90":100,
    "p80":93,
    "p70":89,
    "p50":82
  },
  {
    "name":"Crane Springs",
    "lat":40.46,
    "lon":-115.85,
    "id":260314,
    "highest":107,
    "p97":102,
    "p90":97,
    "p80":92,
    "p70":89,
    "p50":79
  },
  {
    "name":"Crystal",
    "lat":42.983,
    "lon":-113.167,
    "id":103703,
    "highest":103,
    "p97":94,
    "p90":90,
    "p80":85,
    "p70":81,
    "p50":70
  },
  {
    "name":"Currant Creek",
    "lat":38.767,
    "lon":-115.417,
    "id":261406,
    "highest":117,
    "p97":110,
    "p90":105,
    "p80":101,
    "p70":97,
    "p50":92
  },
  {
    "name":"Dead Camel",
    "lat":39.256,
    "lon":-118.96,
    "id":260701,
    "highest":113,
    "p97":105,
    "p90":102,
    "p80":99,
    "p70":96,
    "p50":91
  },
  {
    "name":"Diamond",
    "lat":40.617,
    "lon":-109.243,
    "id":421408,
    "highest":96,
    "p97":87,
    "p90":83,
    "p80":76,
    "p70":72,
    "p50":63
  },
  {
    "name":"Dog Valley",
    "lat":39.572,
    "lon":-120.038,
    "id":41302,
    "highest":96,
    "p97":91,
    "p90":85,
    "p80":82,
    "p70":79,
    "p50":70
  },
  {
    "name":"Double H",
    "lat":41.652,
    "lon":-118.044,
    "id":260207,
    "highest":105,
    "p97":99,
    "p90":94,
    "p80":91,
    "p70":87,
    "p50":77
  },
  {
    "name":"Doyle",
    "lat":40.059,
    "lon":-120.094,
    "id":40724,
    "highest":105,
    "p97":99,
    "p90":95,
    "p80":91,
    "p70":87,
    "p50":80
  },
  {
    "name":"Dry Canyon",
    "lat":41.492,
    "lon":-119.117,
    "id":260203,
    "highest":110,
    "p97":103,
    "p90":100,
    "p80":97,
    "p70":93,
    "p50":84
  },
  {
    "name":"Fish Springs",
    "lat":38.925,
    "lon":-119.641,
    "id":261204,
    "highest":112,
    "p97":104,
    "p90":99,
    "p80":95,
    "p70":92,
    "p50":87
  },
  {
    "name":"Flattop",
    "lat":39.338,
    "lon":-110.6,
    "id":422002,
    "highest":115,
    "p97":105,
    "p90":99,
    "p80":94,
    "p70":91,
    "p50":81
  },
  {
    "name":"Fleck Summit",
    "lat":43.62,
    "lon":-114.899,
    "id":102802,
    "highest":98,
    "p97":90,
    "p90":85,
    "p80":78,
    "p70":71,
    "p50":60
  },
  {
    "name":"Fox Mountain",
    "lat":41.009,
    "lon":-119.551,
    "id":260110,
    "highest":106,
    "p97":98,
    "p90":94,
    "p80":90,
    "p70":86,
    "p50":75
  },
  {
    "name":"Galena",
    "lat":39.382,
    "lon":-119.815,
    "id":260108,
    "highest":105,
    "p97":99,
    "p90":97,
    "p80":94,
    "p70":91,
    "p50":85
  },
  {
    "name":"Gascv",
    "lat":44.168,
    "lon":-111.779,
    "id":102106,
    "highest":92,
    "p97":81,
    "p90":76,
    "p80":69,
    "p70":64,
    "p50":54
  },
  {
    "name":"Grace",
    "lat":42.537,
    "lon":-111.855,
    "id":103902,
    "highest":98,
    "p97":90,
    "p90":84,
    "p80":81,
    "p70":72,
    "p50":62
  },
  {
    "name":"Hewinta",
    "lat":40.953,
    "lon":-110.481,
    "id":420705,
    "highest":84,
    "p97":69,
    "p90":60,
    "p80":54,
    "p70":50,
    "p50":44
  },
  {
    "name":"Hurricane",
    "lat":36.699,
    "lon":-113.207,
    "id":20117,
    "highest":119,
    "p97":111,
    "p90":106,
    "p80":102,
    "p70":95,
    "p50":86
  },
  {
    "name":"Immigration Wash",
    "lat":37.921,
    "lon":-114.16,
    "id":261608,
    "highest":112,
    "p97":104,
    "p90":97,
    "p80":92,
    "p70":87,
    "p50":79
  },
  {
    "name":"Island Park",
    "lat":44.42,
    "lon":-111.384,
    "id":102105,
    "highest":70,
    "p97":58,
    "p90":51,
    "p80":47,
    "p70":43,
    "p50":37
  },
  {
    "name":"Jensen Springs",
    "lat":38.033,
    "lon":-113.517,
    "id":422502,
    "highest":118,
    "p97":106,
    "p90":99,
    "p80":94,
    "p70":90,
    "p50":82
  },  
  {
    "name":"Carpenter Ridge",
    "lat":38.459,
    "lon":-109.047,
    "id":53808,
    "highest":105,
    "p97":95,
    "p90":86,
    "p80":79,
    "p70":74,
    "p50":64
  },
  {
    "name":"Joes Valley ",
    "lat":39.309,
    "lon":-111.323,
    "id":421602,
    "highest":105,
    "p97":90,
    "p90":84,
    "p80":78,
    "p70":73,
    "p50":64
  },
  {
    "name":"Kane Gulch",
    "lat":37.525,
    "lon":-109.892,
    "id":422712,
    "highest":107,
    "p97":97,
    "p90":94,
    "p80":87,
    "p70":81,
    "p50":70
  },
  {
    "name":"kane Spring",
    "lat":37.25,
    "lon":-114.708,
    "id":261604,
    "highest":122,
    "p97":117,
    "p90":111,
    "p80":107,
    "p70":103,
    "p50":99
  },
  {
    "name":"kriley creek",
    "lat":45.356,
    "lon":-113.895,
    "id":101315,
    "highest":97,
    "p97":91,
    "p90":85,
    "p80":78,
    "p70":73,
    "p50":61
  },
  {
    "name":"Kyle",
    "lat":36.267,
    "lon":-115.6,
    "id":261702,
    "highest":127,
    "p97":110,
    "p90":104,
    "p80":99,
    "p70":93,
    "p50":84
  },
  {
    "name":"Larb Hollow",
    "lat":38.016,
    "lon":-111.32,
    "id":422610,
    "highest":115,
    "p97":100,
    "p90":90,
    "p80":80,
    "p70":74,
    "p50":65
  },
  {
    "name":"leadore",
    "lat":44.702,
    "lon":-113.347,
    "id":101312,
    "highest":94,
    "p97":89,
    "p90":82,
    "p80":75,
    "p70":71,
    "p50":62
  },
  {
    "name":"Little Anderson",
    "lat":44.091,
    "lon":-115.881,
    "id":101710,
    "highest":102,
    "p97":90,
    "p90":86,
    "p80":78,
    "p70":69,
    "p50":60
  },
  {
    "name":"Little Creek",
    "lat":44.723,
    "lon":-114.996,
    "id":101805,
    "highest":95,
    "p97":90,
    "p90":86,
    "p80":79,
    "p70":74,
    "p50":62
  },
  {
    "name":"lodgepole",
    "lat":45.378,
    "lon":-115.188,
    "id":101044,
    "highest":85,
    "p97":72,
    "p90":65,
    "p80":59,
    "p70":54,
    "p50":42
  },
  {
    "name":"Logan",
    "lat":36.353,
    "lon":-113.199,
    "id":20107,
    "highest":116,
    "p97":102,
    "p90":94,
    "p80":85,
    "p70":79,
    "p50":71
  },
  {
    "name":"Long Hollow",
    "lat":41.554,
    "lon":-116.231,
    "id":260305,
    "highest":109,
    "p97":102,
    "p90":98,
    "p80":93,
    "p70":87,
    "p50":74

  },
  {
    "name":"Lost Creek",
    "lat":38.771,
    "lon":-111.863,
    "id":421905,
    "highest":107,
    "p97":96,
    "p90":89,
    "p80":82,
    "p70":76,
    "p50":66
  },
  {
    "name":"Majuba",
    "lat":40.773,
    "lon":-118.52,
    "id":260208,
    "highest":105,
    "p97":101,
    "p90":98,
    "p80":94,
    "p70":90,
    "p50":83
  },
  {
    "name":"Markleeville",
    "lat":38.685,
    "lon":-119.768,
    "id":42802,
    "highest":100,
    "p97":95,
    "p90":92,
    "p80":89,
    "p70":86,
    "p50":78
  },
  {
    "name":"McCall",
    "lat":44.89,
    "lon":-116.1,
    "id":101209,
    "highest":69,
    "p97":66,
    "p90":59,
    "p80":50,
    "p70":43,
    "p50":36
  },
  {
    "name":"McCook",
    "lat":39.634,
    "lon":-109.265,
    "id":421405,
    "highest":107,
    "p97":98,
    "p90":91,
    "p80":84,
    "p70":77,
    "p50":66
  },
  {
    "name":"Moody",
    "lat":43.65,
    "lon":-111.576,
    "id":102301,
    "highest":95,
    "p97":84,
    "p90":79,
    "p80":71,
    "p70":63,
    "p50":54
  },
  {
    "name":"Mory Creek",
    "lat":41.456,
    "lon":-117.633,
    "id":260204,
    "highest":122,
    "p97":109,
    "p90":104,
    "p80":100,
    "p70":96,
    "p50":86
  },
  {
    "name":"Mt. Springs",
    "lat":36.333,
    "lon":-115.867,
    "id":261708,
    "highest":115,
    "p97":106,
    "p90":101,
    "p80":98,
    "p70":93,
    "p50":87
  },
  {
    "name":"Mud Spring",
    "lat":39.799,
    "lon":-112.272,
    "id":421502,
    "highest":105,
    "p97":98,
    "p90":91,
    "p80":85,
    "p70":82,
    "p50":72
  },
  {
    "name":"North Fork RS",
    "lat":43.79,
    "lon":-114.421,
    "id":102903,
    "highest":88,
    "p97":83,
    "p90":78,
    "p80":72,
    "p70":65,
    "p50":56
  },
  {
    "name":"North Long Point",
    "lat":37.838,
    "lon":-109.839,
    "id":422710,
    "highest":110,
    "p97":95,
    "p90":86,
    "p80":78,
    "p70":71,
    "p50":58
  },
  {
    "name":"Norway_Flat",
    "lat":40.55,
    "lon":-111.067,
    "id":420706,
    "highest":87,
    "p97":76,
    "p90":90,
    "p80":64,
    "p70":59,
    "p50":51
  },
  {
    "name":"Ohio Gulch",
    "lat":43.601,
    "lon":-114.316,
    "id":102906,
    "highest":100,
    "p97":91,
    "p90":87,
    "p80":82,
    "p70":77,
    "p50":65
  },
  {
    "name":"Otter Creek ",
    "lat":41.753,
    "lon":-111.281,
    "id":420912,
    "highest":104,
    "p97":95,
    "p90":87,
    "p80":79,
    "p70":74,
    "p50":64
  },
  {
    "name":"Pancake",
    "lat":38.304,
    "lon":-116.193,
    "id":261404,
    "highest":119,
    "p97":111,
    "p90":105,
    "p80":101,
    "p70":97,
    "p50":90
  },
  {
    "name":"pine creek",
    "lat":44.25,
    "lon":-116.183,
    "id":101222,
    "highest":100,
    "p97":91,
    "p90":84,
    "p80":78,
    "p70":71,
    "p50":56
  },
  {
    "name":"Pleasant Grove",
    "lat":40.431,
    "lon":-111.75,
    "id":421101,
    "highest":105,
    "p97":95,
    "p90":91,
    "p80":87,
    "p70":85,
    "p50":77
  },
  {
    "name":"Pole Canyon",
    "lat":42.894,
    "lon":-111.841,
    "id":103903,
    "highest":96,
    "p97":87,
    "p90":82,
    "p80":75,
    "p70":70,
    "p50":59
  },
  {
    "name":"Pole Creek",
    "lat":42.052,
    "lon":-115.768,
    "id":103210,
    "highest":102,
    "p97":95,
    "p90":91,
    "p80":87,
    "p70":82,
    "p50":68
  },
  {
    "name":"Potter",
    "lat":43.226,
    "lon":-113.574,
    "id":102907,
    "highest":111,
    "p97":96,
    "p90":91,
    "p80":84,
    "p70":79,
    "p50":67
  },
  {
    "name":"Raft River",
    "lat":42.548,
    "lon":-113.259,
    "id":104104,
    "highest":90,
    "p97":81,
    "p90":77,
    "p80":71,
    "p70":67,
    "p50":58
  },
  {
    "name":"Rays Valley",
    "lat":40.118,
    "lon":-111.275,
    "id":421103,
    "highest":95,
    "p97":85,
    "p90":78,
    "p80":73,
    "p70":70,
    "p50":62
  },
  {
    "name":"Red Butte",
    "lat":39.65,
    "lon":-117.317,
    "id":260504,
    "highest":113,
    "p97":106,
    "p90":103,
    "p80":101,
    "p70":98,
    "p50":89
  },
  {
    "name":"Red Rock",
    "lat":36.135,
    "lon":-115.427,
    "id":261705,
    "highest":128,
    "p97":118,
    "p90":112,
    "p80":107,
    "p70":104,
    "p50":97
  },
  {
    "name":"Road CR",
    "lat":44.372,
    "lon":-114.729,
    "id":101816,
    "highest":96,
    "p97":88,
    "p90":84,
    "p80":78,
    "p70":72,
    "p50":60
  },
  {
    "name":"Rock Lake",
    "lat":42.973,
    "lon":-114.064,
    "id":103403,
    "highest":103,
    "p97":93,
    "p90":88,
    "p80":84,
    "p70":80,
    "p50":69
  },
  {
    "name":"Rock Spring Creek",
    "lat":41.643,
    "lon":-114.643,
    "id":260309,
    "highest":99,
    "p97":93,
    "p90":87,
    "p80":83,
    "p70":79,
    "p50":69
  },
  {
    "name":"Rosebud",
    "lat":41.61,
    "lon":-113.591,
    "id":420914,
    "highest":109,
    "p97":100,
    "p90":95,
    "p80":91,
    "p70":87,
    "p50":82
  },
  {
    "name":"Sevier Res",
    "lat":39.583,
    "lon":-112,
    "id":421501,
    "highest":107,
    "p97":98,
    "p90":93,
    "p80":89,
    "p70":85,
    "p50":78
  },
  {
    "name":"Siard",
    "lat":40.4,
    "lon":-117.615,
    "id":260402,
    "highest":113,
    "p97":106,
    "p90":103,
    "p80":101,
    "p70":98,
    "p50":89
  },
  {
    "name":"Signal Peak",
    "lat":38.632,
    "lon":-112.061,
    "id":421904,
    "highest":109,
    "p97":98,
    "p90":89,
    "p80":83,
    "p70":78,
    "p50":68
  },
  {
    "name":"ski hill",
    "lat":44.943,
    "lon":-116.188,
    "id":101223,
    "highest":93,
    "p97":83,
    "p90":77,
    "p80":70,
    "p70":64,
    "p50":48
  },
  {
    "name":"snake",
    "lat":45.1,
    "lon":-116.738,
    "id":101109,
    "highest":100,
    "p97":94,
    "p90":87,
    "p80":82,
    "p70":76,
    "p50":60
  },
  {
    "name":"Spring Gulch",
    "lat":40.593,
    "lon":-114.203,
    "id":260308,
    "highest":111,
    "p97":103,
    "p90":98,
    "p80":94,
    "p70":91,
    "p50":84
  },
  {
    "name":"Spruce Mtn",
    "lat":40.44,
    "lon":-114.811,
    "id":260306,
    "highest":115,
    "p97":108,
    "p90":102,
    "p80":97,
    "p70":91,
    "p50":82
  },
  {
    "name":"Stag Mtn",
    "lat":41.518,
    "lon":-115.393,
    "id":260315,
    "highest":101,
    "p97":95,
    "p90":92,
    "p80":86,
    "p70":80,
    "p50":68
  },
  {
    "name":"Texas Spring",
    "lat":41.802,
    "lon":-118.451,
    "id":260206,
    "highest":112,
    "p97":104,
    "p90":101,
    "p80":94,
    "p70":88,
    "p50":75
  },
  {
    "name":"Town Creek",
    "lat":43.944,
    "lon":-115.917,
    "id":101708,
    "highest":99,
    "p97":87,
    "p90":80,
    "p80":74,
    "p70":65,
    "p50":53
  },
  {
    "name":"Trail Gulch",
    "lat":42.3,
    "lon":-114.317,
    "id":104004,
    "highest":101,
    "p97":94,
    "p90":89,
    "p80":85,
    "p70":81,
    "p50":68
  },
  {
    "name":"Triange",
    "lat":42.819,
    "lon":-116.586,
    "id":103208,
    "highest":104,
    "p97":91,
    "p90":86,
    "p80":79,
    "p70":73,
    "p50":60
  },
  {
    "name":"Tule Valley",
    "lat":39.35,
    "lon":-113.367,
    "id":421806,
    "highest":117,
    "p97":107,
    "p90":104,
    "p80":99,
    "p70":95,
    "p50":89
  },
  {
    "name":"Tweedy",
    "lat":36.583,
    "lon":-113.717,
    "id":20109,
    "highest":122,
    "p97":111,
    "p90":103,
    "p80":95,
    "p70":91,
    "p50":83
  },
  {
    "name":"Vernon",
    "lat":40.099,
    "lon":-112.427,
    "id":420908,
    "highest":102,
    "p97":100,
    "p90":92,
    "p80":86,
    "p70":81,
    "p50":73
  },
  {
    "name":"weiser river",
    "lat":44.847,
    "lon":-116.427,
    "id":101108,
    "highest":102,
    "p97":96,
    "p90":91,
    "p80":87,
    "p70":82,
    "p50":64
  },
  {
    "name":"White Reef",
    "lat":37.216,
    "lon":-113.378,
    "id":422805,
    "highest":119,
    "p97":115,
    "p90":110,
    "p80":104,
    "p70":102,
    "p50":96
  },
  {
    "name":"Ylwstn  ",
    "lat":40.544,
    "lon":-110.33,
    "id":421301,
    "highest":103,
    "p97":91,
    "p90":82,
    "p80":75,
    "p70":71,
    "p50":62
  },
  {
    "name":"Zion Canyon",
    "lat":37.205,
    "lon":-112.978,
    "id":422808,
    "highest":116,
    "p97":111,
    "p90":105,
    "p80":101,
    "p70":96,
    "p50":89
  },
  {
    "name":"Agua Canyon",
    "lat":37.522,
    "lon":-112.271,
    "id":422903,
    "highest":102,
    "p97":96,
    "p90":88,
    "p80":81,
    "p70":74,
    "p50":66
  },
  {
    "name":"Bearskin",
    "lat":44.383,
    "lon":-115.5,
    "id":101221,
    "highest":93,
    "p97":84,
    "p90":80,
    "p80":74,
    "p70":69,
    "p50":61
  },
  {
    "name":"Black Cedar",
    "lat":38.979,
    "lon":-112.239,
    "id":421805,
    "highest":102,
    "p97":93,
    "p90":89,
    "p80":85,
    "p70":82,
    "p50":76
  },
  {
    "name":"Blacktail",
    "lat":40.278,
    "lon":-110.562,
    "id":421307,
    "highest":105,
    "p97":101,
    "p90":94,
    "p80":87,
    "p70":84,
    "p50":76
  },
  {
    "name":"Boise South",
    "lat":43.567,
    "lon":-116.201,
    "id":102601,
    "highest":95,
    "p97":89,
    "p90":87,
    "p80":85,
    "p70":76,
    "p50":68
  },
  {
    "name":"Brimstone Reservoir",
    "lat":38.308,
    "lon":-113.385,
    "id":422203,
    "highest":116,
    "p97":105,
    "p90":97,
    "p80":89,
    "p70":86,
    "p50":81
  },
  {
    "name":"Bryce Canyon",
    "lat":37.642,
    "lon":-112.172,
    "id":422609,
    "highest":100,
    "p97":90,
    "p90":82,
    "p80":73,
    "p70":70,
    "p50":58
  },
  {
    "name":"Bull Canyon",
    "lat":42.365,
    "lon":-112.706,
    "id":103704,
    "highest":93,
    "p97":89,
    "p90":84,
    "p80":79,
    "p70":67,
    "p50":58
  },
  {
    "name":"Burro Hill",
    "lat":43.84,
    "lon":-110.371,
    "id":480707,
    "highest":81,
    "p97":77,
    "p90":71,
    "p80":64,
    "p70":59,
    "p50":51
  },
  {
    "name":"Cass Lake",
    "lat":47.377778,
    "lon":-94.615,
    "id":211604,
    "highest":44,
    "p97":38,
    "p90":34,
    "p80":32,
    "p70":29,
    "p50":25
  },
  {
    "name":"Cottonwood Mountain",
    "lat":37.984,
    "lon":-112.639,
    "id":422503,
    "highest":109,
    "p97":103,
    "p90":97,
    "p80":90,
    "p70":85,
    "p50":74
  },
  {
    "name":"Dale Bitner",
    "lat":43.058,
    "lon":-111.408,
    "id":103102,
    "highest":71,
    "p97":63,
    "p90":59,
    "p80":54,
    "p70":46,
    "p50":38
  },
  {
    "name":"Dead Indian Ridge",
    "lat":44.319,
    "lon":-117.168,
    "id":101402,
    "highest":105,
    "p97":98,
    "p90":94,
    "p80":91,
    "p70":88,
    "p50":80
  },
  {
    "name":"DeerHV",
    "lat":43.174,
    "lon":-115.152,
    "id":102711,
    "highest":110,
    "p97":102,
    "p90":97,
    "p80":93,
    "p70":86,
    "p50":77
  },
  {
    "name":"Desatoya",
    "lat":39.309,
    "lon":-117.584,
    "id":260503,
    "highest":112,
    "p97":103,
    "p90":99,
    "p80":96,
    "p70":93,
    "p50":85
  },
  {
    "name":"Desert Springs",
    "lat":39.674,
    "lon":-119.768,
    "id":260114,
    "highest":110,
    "p97":102,
    "p90":100,
    "p80":96,
    "p70":94,
    "p50":88
  },
  {
    "name":"Enterprise",
    "lat":37.559,
    "lon":-113.717,
    "id":422803,
    "highest":112,
    "p97":100,
    "p90":91,
    "p80":86,
    "p70":80,
    "p50":72
  },
  {
    "name":"ezra",
    "lat":44.849,
    "lon":-114.026,
    "id":101314,
    "highest":98,
    "p97":91,
    "p90":85,
    "p80":78,
    "p70":72,
    "p50":63
  },

  {
    "name":"Five Mile",
    "lat":39.881,
    "lon":-110.266,
    "id":421304,
    "highest":110,
    "p97":98,
    "p90":90,
    "p80":83,
    "p70":79,
    "p50":71
  },
  {
    "name":"Flint Creek",
    "lat":42.079,
    "lon":-112.183,
    "id":104203,
    "highest":115,
    "p97":99,
    "p90":93,
    "p80":86,
    "p70":75,
    "p50":64
  },
  {
    "name":"Fort Duchesne",
    "lat":40.285,
    "lon":-109.862,
    "id":421415,
    "highest":102,
    "p97":95,
    "p90":87,
    "p80":80,
    "p70":77,
    "p50":69
  },
  {
    "name":"Goose Creek",
    "lat":42.095,
    "lon":-113.896,
    "id":104105,
    "highest":100,
    "p97":92,
    "p90":88,
    "p80":82,
    "p70":75,
    "p50":65
  },
  {
    "name":"Grand Teton",
    "lat":43.724,
    "lon":-110.71,
    "id":480708,
    "highest":78,
    "p97":73,
    "p90":65,
    "p80":61,
    "p70":55,
    "p50":47
  },
  {
    "name":"Gunsight",
    "lat":36.704,
    "lon":-112.583,
    "id":20223,
    "highest":116,
    "p97":111,
    "p90":105,
    "p80":98,
    "p70":93,
    "p50":85
  },
  {
    "name":"Half Moon",
    "lat":42.915,
    "lon":-109.747,
    "id":481309,
    "highest":83,
    "p97":74,
    "p90":68,
    "p80":60,
    "p70":56,
    "p50":47
  },
  {
    "name":"Henry Mountain",
    "lat":38.034,
    "lon":-110.825,
    "id":422611,
    "highest":109,
    "p97":99,
    "p90":91,
    "p80":83,
    "p70":79,
    "p50":68
  },
  {
    "name":"Hoback",
    "lat":43.22,
    "lon":-110.423,
    "id":481302,
    "highest":53,
    "p97":65,
    "p90":58,
    "p80":52,
    "p70":48,
    "p50":38
  },
  {
    "name":"Horse Butte",
    "lat":42.418,
    "lon":-115.202,
    "id":103205,
    "highest":106,
    "p97":98,
    "p90":95,
    "p80":89,
    "p70":81,
    "p50":72
  },
  {
    "name":"Horse Hollow",
    "lat":38.664,
    "lon":-112.683,
    "id":421807,
    "highest":113,
    "p97":97,
    "p90":95,
    "p80":91,
    "p70":89,
    "p50":81
  },
  {
    "name":"Horse Ridge",
    "lat":39.934,
    "lon":-110.861,
    "id":421305,
    "highest":101,
    "p97":88,
    "p90":80,
    "p80":74,
    "p70":70,
    "p50":62
  },
  {
    "name":"Indianola",
    "lat":45.401,
    "lon":-114.163,
    "id":101303,
    "highest":97,
    "p97":85,
    "p90":79,
    "p80":75,
    "p70":68,
    "p50":67
  },
  {
    "name":"Kelly",
    "lat":42.276,
    "lon":-110.806,
    "id":481208,
    "highest":92,
    "p97":87,
    "p90":81,
    "p80":75,
    "p70":68,
    "p50":57
  },
  {
    "name":"Lava Point RAWS",
    "lat":37.392,
    "lon":-113.039,
    "id":422807,
    "highest":95,
    "p97":86,
    "p90":80,
    "p80":73,
    "p70":68,
    "p50":61
  },
  {
    "name":"Moberg Canyon",
    "lat":42.02,
    "lon":-113.09,
    "id":104103,
    "highest":103,
    "p97":96,
    "p90":91,
    "p80":86,
    "p70":79,
    "p50":67
  },
  {
    "name":"Mountain Home",
    "lat":43.028,
    "lon":-115.87,
    "id":102709,
    "highest":100,
    "p97":93,
    "p90":91,
    "p80":88,
    "p70":84,
    "p50":76
  },
  {
    "name":"Mulkey Bar",
    "lat":44.163,
    "lon":-113.394,
    "id":101906,
    "highest":26,
    "p97":22,
    "p90":90,
    "p80":19,
    "p70":18,
    "p50":14
  },
  {
    "name":"Nixon",
    "lat":36.388,
    "lon":-113.158,
    "id":20113,
    "highest":121,
    "p97":102,
    "p90":95,
    "p80":88,
    "p70":82,
    "p50":70
  },
  {
    "name":"Olaf",
    "lat":36.5,
    "lon":-113.817,
    "id":20108,
    "highest":124,
    "p97":117,
    "p90":113,
    "p80":108,
    "p70":104,
    "p50":98
  },
  {
    "name":"Oriental Wash",
    "lat":37.235,
    "lon":-117.496,
    "id":261502,
    "highest":127,
    "p97":118,
    "p90":114,
    "p80":111,
    "p70":109,
    "p50":106
  },
  {
    "name":"Pine Creek Pass",
    "lat":43.54,
    "lon":-111.201,
    "id":102401,
    "highest":94,
    "p97":87,
    "p90":83,
    "p80":76,
    "p70":70,
    "p50":60
  },
  {
    "name":"Raspberry",
    "lat":43.472,
    "lon":-110.018,
    "id":481307,
    "highest":79,
    "p97":72,
    "p90":65,
    "p80":57,
    "p70":53,
    "p50":43
  },
  {
    "name":"Red Rock Peak",
    "lat":44.988,
    "lon":-114.418,
    "id":101316,
    "highest":98,
    "p97":91,
    "p90":86,
    "p80":76,
    "p70":61,
    "p50":52
  },
  {
    "name":"Red Spur",
    "lat":41.637,
    "lon":-111.416,
    "id":420206,
    "highest":88,
    "p97":83,
    "p90":77,
    "p80":72,
    "p70":69,
    "p50":64
  },
  {
    "name":"Robinson Tank (through 2013)",
    "lat":36.471,
    "lon":-112.841,
    "id":20111,
    "highest":113,
    "p97":107,
    "p90":102,
    "p80":93,
    "p70":88,
    "p50":80
  },
  {
    "name":"Salmon",
    "lat":45.15,
    "lon":-113.945,
    "id":101310,
    "highest":97,
    "p97":89,
    "p90":86,
    "p80":79,
    "p70":70,
    "p50":63
  },
  {
    "name":"Sho Pai",
    "lat":42.02,
    "lon":-116.211,
    "id":103211,
    "highest":98,
    "p97":91,
    "p90":89,
    "p80":84,
    "p70":79,
    "p50":72
  },
  {
    "name":"Skull Gulch",
    "lat":45.336,
    "lon":-114.502,
    "id":101311,
    "highest":97,
    "p97":89,
    "p90":81,
    "p80":75,
    "p70":62,
    "p50":59
  },
  {
    "name":"Snider Basin",
    "lat":42.491,
    "lon":-110.527,
    "id":481306,
    "highest":73,
    "p97":65,
    "p90":55,
    "p80":50,
    "p70":45,
    "p50":39
  },
  {
    "name":"Stanley RS",
    "lat":44.169,
    "lon":-114.926,
    "id":101809,
    "highest":85,
    "p97":75,
    "p90":71,
    "p80":60,
    "p70":53,
    "p50":44
  },
  {
    "name":"Stillwater",
    "lat":48.539444,
    "lon":-114.559444,
    "id":240221,
    "highest":85,
    "p97":58,
    "p90":50,
    "p80":46,
    "p70":41,
    "p50":35
  },
  {
    "name":"Taylor Ranch",
    "lat":45.104,
    "lon":-114.849,
    "id":101224,
    "highest":94,
    "p97":90,
    "p90":84,
    "p80":79,
    "p70":71,
    "p50":60
  },
  {
    "name":"Telegraph Flat",
    "lat":37.2,
    "lon":-112.025,
    "id":422902,
    "highest":116,
    "p97":107,
    "p90":100,
    "p80":92,
    "p70":86,
    "p50":80
  },
  {
    "name":"Tom Best Spring",
    "lat":37.829,
    "lon":-112.119,
    "id":422608,
    "highest":108,
    "p97":94,
    "p90":90,
    "p80":81,
    "p70":76,
    "p50":50
  },
  {
    "name":"Twin Butte",
    "lat":42.691,
    "lon":-115.195,
    "id":103209,
    "highest":107,
    "p97":99,
    "p90":96,
    "p80":90,
    "p70":87,
    "p50":79
  },
  {
    "name":"WagonTown",
    "lat":43.573,
    "lon":-115.327,
    "id":102712,
    "highest":104,
    "p97":97,
    "p90":92,
    "p80":87,
    "p70":83,
    "p50":73
  },
  {
    "name":"Walker",
    "lat":38.57,
    "lon":-119.455,
    "id":43707,
    "highest":109,
    "p97":105,
    "p90":102,
    "p80":100,
    "p70":97,
    "p50":93
  },
  {
    "name":"Wildhorse",
    "lat":39.545,
    "lon":-109.908,
    "id":421416,
    "highest":114,
    "p97":103,
    "p90":94,
    "p80":85,
    "p70":80,
    "p50":69
  }
]
var dateField = document.createElement('div');
dateField.className = 'display-overlay ol-unselectable ol-control';
dateField.innerHTML = 'DATE';
var displayDate = new ol.control.Control({
  element: dateField
});

var start = document.createElement('input');
start.id = 'start';
start.className = 'ol-control pickStart';
start.value = 'Start Date';

var end = document.createElement('input');
end.id = 'end';
end.className = 'ol-control pickEnd';
end.value = 'End Date'

var playButton = document.getElementById('playButton');
playButton.className = "ol-control play   ";
playButton.innerHTML = 'PLAY';

var range = document.createElement('div');
range.appendChild(start);
range.appendChild(end);
range.appendChild(playButton);
var startCtrl = new ol.control.Control({
  element: range
});
var endCtrl = new ol.control.Control({
  element: range
});
var simGo = new ol.control.Control({
  element: range 
})


var startDate,
    endDate,
    simStart,
    simEnd,
    updateStartDate = function() {
      startPicker.setStartRange(startDate);
      endPicker.setStartRange(startDate);
      endPicker.setMinDate(startDate);
    },
    updateEndDate = function() {
      startPicker.setEndRange(endDate);
      startPicker.setMaxDate(endDate);
      endPicker.setEndRange(endDate);
    },
    startPicker = new Pikaday({
      field: start,
      position: 'top left',
      theme: 'dark-theme',
      minDate: new Date(2010, 01, 01),
      maxDate: new Date(2020, 12, 31),
      onSelect: function() {
        startDate = this.getDate();
        simStart = this.getDate().valueOf();
        updateStartDate();
      }
    }),
    endPicker = new Pikaday({
      field: end,
      position: 'top left',
      theme: 'dark-theme',
      minDate: new Date(2010, 01, 01),
      maxDate: new Date(2020, 12, 31),
      onSelect: function() {
        endDate = this.getDate();
        simEnd = this.getDate().valueOf();
        updateEndDate();
      }
    }),
    _startDate = startPicker.getDate(),
    _endDate = endPicker.getDate();

if (_startDate) {
  startDate = _startDate;
  updateStartDate();
}

if (_endDate) {
  endDate = _endDate;
  updateEndDate();
}


var mapboxToken = 'pk.eyJ1IjoicnRpcHBldHRzIiwiYSI6ImNpb2huaWtuNDAwNnF1NW0xNWFhYXJiM20ifQ.-c3uBsqfQoJgd3gG4TbNLw#0/0/0/0';

var mapbox = new ol.layer.Tile({
  title: 'mapbox run-bike-hike',
  type: 'base',
  source: new ol.source.XYZ({
    attributions: '© <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> ' +
                  '© <a href="http://www.openstreetmap.org/copyright">' +
                  'OpenStreetMap contributors</a>',
    crossOrigin: 'anonymous',
    // tileSize: [512, 512],
    // url: 'https://api.mapbox.com/styles/v1/mapbox/outdoors-v9/tiles/{z}/{x}/{y}?access_token=' + mapboxToken
    url: 'https://api.tiles.mapbox.com/v4/mapbox.run-bike-hike/{z}/{x}/{y}.png?access_token=' + mapboxToken
  }),
  wrapX: false,
  visible: true
});


var vectorStyle = new ol.style.Style({
  // fill: new ol.style.Fill({
  //   // color: 'rgba(0, 0, 0, 0.2)'
  //   color: 'rgba(141, 92, 141, 0.2)'
  // }),
  stroke: new ol.style.Stroke({
    // color: 'rgba(255, 255, 255, 1)',
    // color: 'rgba(215, 212, 60, 1)',
    // color: '#683A5E',
    color: 'rgba(89, 74, 48, 1)',
    width: 2
  }),
  text: new ol.style.Text({
    font: '.9rem Montserrat, sans-serif',
    fill: new ol.style.Fill({
      color: '#000'
    })
    // ,
    // stroke: new ol.style.Stroke({
    //   color: '#fff',
    //   width: 3
    // })
  })
});

var vectorSource = new ol.source.Vector({
  // url: 'data/topojson/egpGbccLocal.topojson',
  // url: 'data/topojson/gbccBoundaries.topojson',
  // url: 'data/topojson/gbccLocalWebsites.topojson',
  // format: new ol.format.TopoJSON()
  url: 'data/geojson/rawsThiessen.geojson',
  format: new ol.format.GeoJSON()
});

function between(x, min, max) {
  return x >= min && x < max;
}

// var colors = [ 'rgba(0, 204, 0, .8)',  'rgba(255, 255, 0, .8)',  'rgba(255, 167, 0, .8)',  'rgba(250, 6, 6, .8)',  'rgba(142, 0, 20, .8)',  'rgba(167, 6, 248, .8)'];
var colors = [ 'rgba(0, 204, 0, .5)',  'rgba(255, 255, 0, .5)',  'rgba(255, 167, 0, .5)',  'rgba(250, 6, 6, .5)',  'rgba(142, 0, 20, .5)',  'rgba(167, 6, 248, .5)'];
var rawStyleCache = {};
var rawStyleFunction = function(feature) {
  var id = feature.get('id');
  var erc = results[id];
  var range = [0, feature.get('p50'), feature.get('p70'), feature.get('p80'), feature.get('p90'), feature.get('p97'), erc+1];
  var newColors = colors.filter(function(curr, i) {
    return (between(erc, range[i], range[i+1]))
  });
  var color = newColors[0] === undefined ? 'rgba(140, 230, 246, .2)' : newColors[0];
  var style = new ol.style.Style({
    fill: new ol.style.Fill({
      color: color
    }),
    stroke: new ol.style.Stroke({
      // color: 'rgba(255, 255, 255, 1)',
      // color: 'rgba(215, 212, 60, 1)',
      // color: '#683A5E',
      color: 'rgba(238, 238, 238, .3)',
      width: 4
    }),
    text: new ol.style.Text({
      font: '.9rem Montserrat, sans-serif',
      fill: new ol.style.Fill({
        color: '#000'
      })
      // ,
      // stroke: new ol.style.Stroke({
      //   color: '#fff',
      //   width: 3
      // })
    })
  });
  return style;
}

var vectorLayer = new ol.layer.Vector({
  title: 'RAWS Thiessen Polygons',
  source: vectorSource,
  // source: new ol.source.Vector({
  //   features: (new ol.format.TopoJSON()).readFeatures(gbccBoundaries)
  // }),
  // source: new ol.source.Vector({
  //   // url: 'data/topojson/egpGbccLocal.topojson',
  //   // url: 'data/topojson/gbccBoundaries.topojson',
  //   url: 'data/topojson/gbccLocalWebsites.topojson',
  //   format: new ol.format.TopoJSON()
  //   // url: 'data/geojson/gbccLocalWebsites.geojson',
  //   // format: new ol.format.GeoJSON()
  // }),
  wrapX: false,
  // minResolution: 0,
  // maxResolution: 5000,
  visible: true,
  style: rawStyleFunction
});

// var rawsSource = new ol.source.Vector({
//   url: 'data/geojson/raws1.geojson',
//   format: new ol.format.GeoJSON()
// });

// var rawsLayer = new ol.layer.Vector({
//   title: 'RAWS Stations',
//   source: rawsSource,
//   wrapX: false,
//   // minResolution: 0,
//   // maxResolution: 5000,
//   visible: true
// });
var mapboxDark = new ol.layer.Tile({
  title: 'MapBox Dark',
  type: 'base',
  source: new ol.source.XYZ({
    attributions: '© <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> ' +
                  '© <a href="http://www.openstreetmap.org/copyright">' +
                  'OpenStreetMap contributors</a>',
    crossOrigin: 'anonymous',
    url: 'https://api.tiles.mapbox.com/v4/mapbox.dark/{z}/{x}/{y}.png?access_token=' + mapboxToken
  }),
  wrapX: false
});

var mapboxLight = new ol.layer.Tile({
  title: 'MapBox Light',
  type: 'base',
  source: new ol.source.XYZ({
    attributions: '© <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> ' +
                  '© <a href="http://www.openstreetmap.org/copyright">' +
                  'OpenStreetMap contributors</a>',
    crossOrigin: 'anonymous',
    url: 'https://api.tiles.mapbox.com/v4/mapbox.light/{z}/{x}/{y}.png?access_token=' + mapboxToken
  }),
  wrapX: false
});

var bigScreen = new ol.control.FullScreen();
var controls = [
  new ol.control.Attribution(
  ),
  new ol.control.MousePosition({
    undefinedHTML: 'outside',
    projection: 'EPSG:4326',
    coordinateFormat: function(coordinate) {
      return ol.coordinate.format( coordinate, '{y}, {x}', 4);
    }
  }),
  new ol.control.Rotate({
    autohide: false
  }),
  new ol.control.ScaleLine({
  }),
  new ol.control.Zoom(
  ),
  new ol.control.ZoomSlider(),
  bigScreen,
  displayDate,
  simGo
];

var layers = [
  // new ol.layer.Tile({
  //   source: new ol.source.OSM({
  //     // attributions: [
  //     //   'All maps © <a href="http://www.opencyclemap.org/">OpenCycleMap</a>',
  //     //   ol.source.OSM.ATTRIBUTION
  //     // ],
  //     // url: 'http://{a-c}.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png'
  //     attributions: [
  //       "Map tiles by Carto, under CC BY 3.0.",
  //       ol.source.OSM.ATTRIBUTION
  //     ],
  //     url: 'http://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png'
  //   }),
  //   title: "Open Street Map",
  //   type: 'base',
  //   wrapX: false,
  //   visible: true
  // }),
  // mapboxDark,
  mapboxLight,
  vectorLayer,
];


var overallView = new ol.View({
  // center: ol.proj.transform([-114.012036, 40.440194], 'EPSG:4326','EPSG:3857'),
  center: [-12753260.184760537, 4948659.629345282],
  zoom: 5.55,
  // minZoom: 1,
  // maxZoom: 20,
  // extent:[ -13385849.855545742, 4164163.9360093023, -12120670.513975333, 5733155.322681262 ]
});

var map = new ol.Map({
    controls: controls,
	layers: layers,
	target: 'map',
	view: overallView,
    logo: ({
    href: 'http://gacc.nifc.gov/gbcc/',
    src: 'data/GBCC_1b.png' 
  })
});
map.getView().fit([ -13385849.855545742, 4164163.9360093023, -12120670.513975333, 5733155.322681262 ], (map.getSize()), {padding: [5, 5, 5, 5], constrainResolution: false});


// vectorSource.once('change', function(e) {
//   if (vectorSource.getState() === 'ready') {
//     rawPoints.map(function(c, i) {
//       vectorSource.getFeaturesAtCoordinate(ol.proj.transform([c["lon"], c["lat"]], 'EPSG:4326','EPSG:3857'))[0] ? 
//       (vectorSource.getFeaturesAtCoordinate(ol.proj.transform([c["lon"], c["lat"]], 'EPSG:4326','EPSG:3857'))[0].setProperties({
//         "name": c["name"],
//         "lat": c["lat"],
//         "lon": c["lon"],
//         "id": c["id"],
//         "highest": c["highest"],
//         "p97": c["p97"],
//         "p90": c["p90"],
//         "p80": c["p80"],
//         "p70": c["p70"],
//         "p50": c["p50"]
//       }), vectorSource.getFeaturesAtCoordinate(ol.proj.transform([c["lon"], c["lat"]], 'EPSG:4326','EPSG:3857'))[0].setStyle(
//         new ol.style.Style({
//           fill: new ol.style.Fill({
//             color: 'black'
//           }),
//           stroke: new ol.style.Stroke({
//             color: 'rgba(89, 74, 48, 1)',
//             width: 2
//           })
//         })
//       )) : console.log(c["name"]);
//       return vectorSource;
//     });
//     var allFeatures = vectorSource.getFeatures();
//     var format = new ol.format.GeoJSON();
//     var data = format.writeFeatures(allFeatures, {featureProjection: 'EPSG:3857'})  
//     console.log(data);
//   }
// })

// <div id="olMap"></div>
//     <canvas id="myCanvas" width="578" height="250"></canvas>
//     <script>
//       var canvas = document.getElementById('myCanvas');
//       var context = canvas.getContext('2d');
//       var x = canvas.width / 2;
//       var y = canvas.height / 2;
//       var radius = 15;
//       var startAngle = 0 * Math.PI;
//       var endAngle = 2 * Math.PI;
//       var counterClockwise = false;

//       context.beginPath();
//       context.arc(x, y, radius, startAngle, endAngle, counterClockwise);
//       context.lineWidth = 30;

//       // line color
//       context.strokeStyle = 'black';
//       context.stroke();
//     </script>
// function makeGradient(r) {
//   var cnv = document.createElement('canvas');
//   var ctx = cnv.getContext('2d');
//   var gradient = ctx.createRadialGradient(r,r,r,r,r,0);
  
//   gradient.addColorStop(0,'#00f');
//   gradient.addColorStop(.2,'#0ff');
//   gradient.addColorStop(.4,'#0f0');
//   gradient.addColorStop(.6,'#ff0');
//   gradient.addColorStop(1,'#f00');


//   return gradient;
// }

// var vectorLayer = new ol.layer.Vector({
//     source: new ol.source.Vector()
// });
// var map = new ol.Map({
//     target: $('#olMap')[0],
//     ol3Logo: false,
//     layers: [
//     new ol.layer.Tile({
//         source: new ol.source.TileJSON({
//             url: 'http://api.tiles.mapbox.com/v3/mapbox.geography-class.jsonp'
//         })
//     }),
//     vectorLayer],
//     view: new ol.View({
//         center: [0, 0],
//         zoom: 3
//     })
// });

// var point = new ol.Feature({
//     geometry: new ol.geom.Point([0, 0]),
//     name: 'test'
// });
// //Holds the Polygon feature  
// var polyFeature = new ol.Feature({
//     geometry: new ol.geom.Polygon([
//         [
//             [10.689697265625, -25.0927734375],
//             [34.595947265625, -20.1708984375],
//             [38.814697265625, -35.6396484375],
//             [13.502197265625, -39.1552734375],
//             [10.689697265625, -25.0927734375]
//         ]
//     ])
// });
// polyFeature.getGeometry().transform('EPSG:4326', 'EPSG:3857');
// vectorLayer.getSource().addFeature(point);
// r=50;
// point.setStyle(new ol.style.Style({
//     image: new ol.style.Circle({
//         radius: r,
//         fill: new ol.style.Fill({
//             color: makeGradient(r) 
//         }),
//         //stroke: new ol.style.Stroke({
//           //  color: 'rgb(255, 141, 77)',
//            // width: 2
//         //})
//     })
// }));


// vectorLayer.getSource().addFeature(polyFeature);
// var animate = function (pulsateCount) {
//     var style = point.getStyle(),
//         image = style.getImage(),
//         r = image.getRadius(),
//         currR = r,
//         maxR = 2 * r,
//         sign = 1;
//     vectorLayer.getSource().removeFeature(point);

//     var pulsate = function (event) {
//         var vectorContext = event.vectorContext;
//         if (currR > maxR) {
//             sign = -1;
//             pulsateCount--;
//         } else if (currR < r) {
//             sign = 1;
//             if (!pulsateCount) {
//                 map.un('postcompose', pulsate);
//                 vectorLayer.getSource().addFeature(point);
//                 return;
//             }
//         }
//         currR += sign * 0.1;
//         vectorContext.drawFeature(point, new ol.style.Style({
//             image: new ol.style.Circle({
//                 radius: currR,
//                 fill: new ol.style.Fill({
//                   color: makeGradient(currR) 
//                 }),
//                 //stroke: image.getStroke()
//             })
//         }));
//         map.render();
//     };

//     map.on('postcompose', pulsate);
// };

//animate(1);

ol.Feature.prototype.getLayer = function() {
  var this_ = this, layer_;
  var sameFeature = function(feature){
    return (this_ === feature) ? true : false;
  };
  map.getLayers().forEach(function(layer) {
    var source = layer.getSource();
    if (source instanceof ol.source.Vector) {
      var features = source.getFeatures();
      if (features.length > 0) {
        var found = features.some(sameFeature);
          if (found) {
            layer_ = layer;
          }
        }
      }
  });
  return layer_;
};

function isTouchDevice() {
  return 'ontouchstart' in document.documentElement;
}
if (isTouchDevice()) {
  // on Mobile
  console.log('is touch');
  var selectTap = new ol.interaction.Select({
    condition: ol.events.condition.click,
    layers: [],
    // filter: function(feature, layer) {
    //   if (layer.get('overlay') == true)
    //     return true;
    // },
    style: function(feature) {
      if (feature.getLayer().get('id') == 'team') {
        var acres = feature.get('DailyAcres') ? feature.get('DailyAcres') : '';
        var style = new ol.style.Style({
          image: new ol.style.Circle({
            // fill: new ol.style.Fill({
            //   color: 'rgba(254,253,6,.1)'
            // }),
            stroke: new ol.style.Stroke({color: 'rgba(145,9,198,1)', width: 4}),
            radius: (acres <= 18.5) ? 3 + 3.5 : 3 + 1.2 * Math.log(acres)
          })
        }); 
      }
      return style;
    }  
  });

  map.addInteraction(selectTap);

  selectTap.on('select', function(e) {
    var coordinate;
    var feature = e.selected[0];
    // var layer = feature.getLayer();
    if (feature) {
      var feature = e.selected[0];
      function displayInfo() {
        // var coordinate = e.coordinate;
        // var hdms = ol.coordinate.toStringHDMS(ol.proj.transform(coordinate, 'EPSG:3857', 'EPSG:4326'));
        // overlay.setPosition(coordinate); 
      }
      function displayResources(items) {
        function popRes(arr, target, resk, resIds) {
          target.innerHTML = '';
          var count = 0;         
        }
        return items.map(function(current_item, index, initial_array) {
          Resources[index].innerHTML = '';
          Object.keys(current_item).length === 0 && current_item.constructor === Object 
          ? (Resources[index].innerHTML = 0 + resIds[index]) : popRes(current_item, ResourcesP[index], Resources[index], resIds[index]);
        });
      }      
      displayInfo();
      map.getOverlayById('dataOverlay') ? overlay.setPosition(coordinate) : ''; 
      displayResources();
    }
  });
}
else {
  // on Desktop
  console.log('no touch');
  var selectHover = new ol.interaction.Select({
    condition: ol.events.condition.pointerMove,
    layers: [vectorLayer],
    // filter: function(feature, layer) {
    //   if (layer.get('overlay') == true)
    //     return true;
    // },
    style: function(feature) {
      if (feature.getLayer().get('id') == 'team') {
        var acres = feature.get('DailyAcres') ? feature.get('DailyAcres') : '';
        var style = new ol.style.Style({
          image: new ol.style.Circle({
            // fill: new ol.style.Fill({
            //   color: 'rgba(254,253,6,.1)'
            // }),
            stroke: new ol.style.Stroke({color: 'rgba(145,9,198,1)', width: 4}),
            radius: (acres <= 18.5) ? 3 + 3.5 : 3 + 1.2 * Math.log(acres)
          })
        }); 
      }
      return style;
    }  
  });

  map.addInteraction(selectHover);

  selectHover.on('select', function(e) {
    var feature = e.selected[0];
    // var layer = feature.getLayer();
    if (feature) {
      var feature = e.selected[0];
      function displayInfo() {
        // var coordinate = e.coordinate;
        // var hdms = ol.coordinate.toStringHDMS(ol.proj.transform(coordinate, 'EPSG:3857', 'EPSG:4326'));
        // overlay.setPosition(coordinate); 
      }
      function displayResources(items) {
        function popRes(arr) {};
      }   
      displayInfo();
      map.getOverlayById('dataOverlay') ? overlay.setPosition(coordinate) : ''; 
      displayResources();
    }
  });

  var selectClick = new ol.interaction.Select({
    condition: ol.events.condition.click,
    layers: [
      mapboxDark,
      mapboxLight,
      mapbox, 
      // raster,
      // bing,
      // openTopo,
      // stamen,
      // usgsTopo,
      vectorLayer,
    ],
    style: new ol.style.Style({
      // fill: new ol.style.Fill({
      //   // color: 'rgba(0,0,255, .1)',
      //   color: 'rgba(255, 145, 20, .1)'
      // }),
      stroke: new ol.style.Stroke({
        // color: 'rgba(168, 0, 2, .8)',
        color: 'rgba(0,0,255, .8)',
        // color: '#f00',
        width: 3
      })
    })  
  });
  map.addInteraction(selectClick);

  selectClick.on('select', function(e) {
    var feature = e.selected[0];
    if (feature) {
      // var polygon = (feature.getGeometry());// @type {ol.geom.SimpleGeometry 
      // var size = (map.getSize()); // @type {ol.Size} 
      // map.getView().fit(polygon, size, {padding: [0, 0, 0, 0], constrainResolution: false});
      // var aa = polygon.getExtent();
      // var oo = ol.extent.getCenter(aa);
      // let duration = 1500; // ie11+
      // var self = this;
      // var duration = 1500;
      var start = +new Date();
      // var pan = ol.animation.pan({
      //   duration: 800,
      //   source: (map.getView().getCenter()),  // @type {ol.Coordinate}
      //   start: start
      // });sty
      // var bounce = ol.animation.bounce({
      //   duration: 800, // or could use the "this" keyword because duration is a variable defined above, 
      //   resolution: 1.2 * map.getView().getResolution(),
      //   start: start
      // });
      // map.beforeRender(pan, bounce);
      // // map.getView().setCenter(oo);
      // map.getView().fit(polygon, size, {padding: [5, 5, 5, 5], constrainResolution: false});
    }
    else {
      map.beforeRender(
        ol.animation.pan({
          duration: 800,
          source: (map.getView().getCenter()),  // @type {ol.Coordinate}
          start: start
        }),
        ol.animation.bounce({
          duration: 800, // or could use the "this" keyword because duration is a variable defined above, 
          resolution: 1.3 * map.getView().getResolution(),
          start: start
        })
      );
      map.getView().fit([ -13385849.855545742, 4164163.9360093023, -12120670.513975333, 5733155.322681262 ], (map.getSize()), {padding: [5, 5, 5, 5], constrainResolution: false});
      // map.setView(new ol.View({
      //     // center: ol.proj.transform([-114.012036, 40.440194], 'EPSG:4326','EPSG:3857'),
      //     center: [-12753260.184760537, 4948659.629345282],
      //     // zoom: 5.55,
      //     resolution: map.getView().getResolution(),
      //     // minZoom: 5,
      //     // maxZoom: 9.8,
      //     extent: bb
      //   })
      // );
        // map.getView().setZoom(5);
        // map.getView().setZoom(map.getView().getZoom()+1);
    } 
  });
}
map.on('singleclick', function(evt) {
  var coordinate = evt.coordinate;
  var hdms = ol.coordinate.toStringHDMS(ol.proj.transform(
      coordinate, 'EPSG:3857', 'EPSG:4326'));

  content.innerHTML = '<p>You clicked here:</p><code>' + hdms +
      '</code>';
  overlay.setPosition(coordinate);
});